<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <script type="text/javascript" src="http://d3js.org/d3.v5.min.js"></script> -->
    <script type="text/javascript" src="../d3.min.js"></script>
    <title>Document</title>
</head>
<body>
    <svg></svg>
    <script>

        const svg = d3.select('svg')
            .attr('width',600)
            .attr('height',600);
        const g = svg.append('g');
        const dataset=[10, 20, 30, 23, 13, 40, 27, 35, 20];

        // scaleBand 分段比例尺， 划分为均匀的分段
        const xScale = d3.scaleBand()
            // 第一个元素对应第一个分段，第二个元素对应第二个分段，以此类推
            // d3.range(dataset.length) 会生成一个从0 到 dataset.length 的数组
            .domain(d3.range(dataset.length))
            // 0 到 500 映射到 0 到 8
            .range([0,500]),
        yScale=d3.scaleLinear()
            .domain([0,d3.max(dataset)])
            // y越小， 值越大
            .range([300,0]);
        
        console.log('d3.range', d3.range(dataset.length))

        // console.log('xScale', xScale(4))
        const xAxis=d3.axisBottom(xScale),
              yAxis=d3.axisLeft(yScale);

        console.log(xAxis, yAxis)

        // console.log(g.append('g').attr('transform','translate(100,350)').call(xAxis))

        // 将刻度尺添加在分组上
        g.append('g').attr('transform','translate(100,350)').call(xAxis);
        g.append('g').attr('transform','translate(100,50)').call(yAxis);

        const rectWidth = 30;
        
        g.append('g')
            .selectAll('rect')
            .data(dataset)
            .enter()
            .append('rect')
            .attr('x',function(d,i){
                return xScale(i) + 100 + (xScale(1) / 2) - rectWidth / 2;
            })
            // 一开始所有的柱状图形都在x轴线上
            .attr('y',function(d,i){
                return 350;
            })
            .attr('width',function(d,i){
                return rectWidth;
            })
            // 填充颜色
            .attr('fill','blue')
            // 鼠标移动事件
            // .on('mouseenter',function(){
            //     d3.select(this).transition().duration(100).attr('fill','pink');
            // })
            // .on('mouseleave',function(){
            //     d3.select(this).transition().duration(100).attr('fill','blue');
            // })
            // 平滑过渡到目标状态
            .transition()
            // 持续一秒
            .duration(1000)
            // 延迟执行
            .delay(function(d,i){
                return 100*i;
            })
            // 
            .attr('height',function(d,i){
                return 300-yScale(d);
            })
            .attr('y',function(d,i){
                // 50 因为y轴向下移动了50， 所以需要 +50 补回去0
                return yScale(d)+ 50;
            })
    </script>
    
</body>
</html>